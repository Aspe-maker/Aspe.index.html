using UnityEngine;
using UnityEngine.UI;

public class MiniMinecraftMobile : MonoBehaviour
{
    public float speed = 5f; // سرعة تحرك اللاعب
    public Camera playerCamera; // الكاميرا المرفقة باللاعب
    public GameObject blockPrefab; // الكتلة التي سيتم وضعها
    public Joystick joystick; // عصا التحكم الافتراضية
    public Button destroyButton; // زر لتدمير الكتل
    public Button placeButton; // زر لوضع الكتل
    public Text inventoryText; // نص لعرض الجرد

    private int inventoryCount = 0; // عدد الكتل في الجرد

    void Start()
    {
        // إعداد الأزرار
        destroyButton.onClick.AddListener(DestroyBlock);
        placeButton.onClick.AddListener(PlaceBlock);
        UpdateInventoryUI();
    }

    void Update()
    {
        MovePlayer(); // تحريك اللاعب
    }

    void MovePlayer()
    {
        float moveX = joystick.Horizontal * speed * Time.deltaTime;
        float moveZ = joystick.Vertical * speed * Time.deltaTime;

        transform.Translate(moveX, 0, moveZ);
    }

    void DestroyBlock()
    {
        Ray ray = playerCamera.ScreenPointToRay(new Vector3(Screen.width / 2, Screen.height / 2, 0));
        if (Physics.Raycast(ray, out RaycastHit hit))
        {
            if (hit.collider.CompareTag("Block"))
            {
                Destroy(hit.collider.gameObject);
                inventoryCount++; // زيادة عدد الكتل في الجرد
                UpdateInventoryUI();
            }
        }
    }

    void PlaceBlock()
    {
        if (inventoryCount > 0) // التأكد من وجود كتل في الجرد
        {
            Ray ray = playerCamera.ScreenPointToRay(new Vector3(Screen.width / 2, Screen.height / 2, 0));
            if (Physics.Raycast(ray, out RaycastHit hit))
            {
                Vector3 placePosition = hit.point + hit.normal * 0.5f; // وضع الكتلة بجانب الكتلة التي تم النقر عليها
                Instantiate(blockPrefab, placePosition, Quaternion.identity);
                inventoryCount--; // تقليل عدد الكتل في الجرد
                UpdateInventoryUI();
            }
        }
    }

    void UpdateInventoryUI()
    {
        inventoryText.text = "Blocks: " + inventoryCount; // تحديث نص الجرد
    }
}
